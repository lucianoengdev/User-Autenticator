{% extends 'base.html' %}

{% block tittle %}
    Dimensionamento de Trilho
{% endblock %}

{% block style %}
<style>
    .result-card {
        background-color: #fff3cd; /* Amarelo claro para diferenciar */
        border-left: 5px solid #ffc107;
        padding: 20px;
        margin-top: 20px;
        border-radius: 5px;
    }
    .result-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: #856404;
    }
</style>
{% endblock %}

{% block content %}
<div class="container pb-5">
    <div class="row">
        <div class="col-md-5">
            <h2 class="mb-4 text-warning">Dimensionamento de Trilho</h2>
            <p class="text-muted">Verificação de tensões pelos métodos de Winkler e Zimmermann.</p>
            
            <form method="POST">
                {{ form.hidden_tag() }}
                
                <h5 class="mb-3 border-bottom pb-2">Cargas e Operação</h5>
                <div class="row g-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.carga_por_eixo(class="form-control", placeholder=" ") }}
                            {{ form.carga_por_eixo.label }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.velocidade(class="form-control", placeholder=" ") }}
                            {{ form.velocidade.label }}
                        </div>
                    </div>
                </div>

                <h5 class="mb-3 border-bottom pb-2 mt-2">Infraestrutura</h5>
                <div class="row g-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.espacamento_dormente(class="form-control", placeholder=" ") }}
                            {{ form.espacamento_dormente.label }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.largura_dormente(class="form-control", placeholder=" ") }}
                            {{ form.largura_dormente.label }}
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="form-floating mb-3">
                            {{ form.coef_lastro(class="form-control", placeholder=" ") }}
                            {{ form.coef_lastro.label }}
                        </div>
                    </div>
                </div>

                <h5 class="mb-3 border-bottom pb-2 mt-2">Trilho (Propriedades)</h5>
                <div class="row g-2">
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.momento_inercia(class="form-control", placeholder=" ") }}
                            {{ form.momento_inercia.label }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.modulo_resistencia(class="form-control", placeholder=" ") }}
                            {{ form.modulo_resistencia.label }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.modulo_elasticidade(class="form-control", placeholder=" ") }}
                            {{ form.modulo_elasticidade.label }}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-floating mb-3">
                            {{ form.tensao_admissivel(class="form-control", placeholder=" ") }}
                            {{ form.tensao_admissivel.label }}
                        </div>
                    </div>
                </div>

                {{ form.submit(class="btn btn-warning w-100 py-3 mt-3 fw-bold") }}
            </form>
        </div>

        <div class="col-md-7">
            <h2 class="mb-4">Análise Estrutural</h2>
            {% if resultados %}
                <div class="alert {{ 'alert-success' if resultados.status == 'APROVADO' else 'alert-danger' }} text-center">
                    <h1 class="display-6 fw-bold">{{ resultados.status }}</h1>
                    <p class="mb-0">A tensão atuante é {{ 'menor' if resultados.status == 'APROVADO' else 'MAIOR' }} que a admissível.</p>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="result-card bg-light border-secondary">
                            <h6>Parâmetros Calculados</h6>
                            <hr>
                            <p class="mb-2">Carga Roda (P): <strong>{{ resultados.P }} kgf</strong></p>
                            
                            <div class="mb-2 p-2 rounded" style="background-color: #e9ecef;">
                                <p class="mb-0">Coef. Dinâmico (Cd): <strong>{{ resultados.Cd }}</strong></p>
                                
                                <small class="text-muted d-block" style="font-size: 0.85em;">
                                    Calculado (fórmula): {{ resultados.Cd_calc }}
                                </small>
                                
                                <small class="text-primary fw-bold" style="font-size: 0.75em;">
                                    ⓘ {{ resultados.msg_cd }}
                                </small>
                            </div>
                            <p class="mb-0">Coef. Superestrutura (γ): <strong>{{ resultados.gamma }}</strong></p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="result-card">
                            <h6>Tensão de Trabalho (σ)</h6>
                            <div class="result-value {{ resultados.css_class }}">{{ resultados.sigma_calc }}</div>
                            <small class="text-muted">kgf/cm²</small>
                        </div>
                    </div>
                </div>

                <div class="row mt-3">
                    <div class="col-12">
                        <div class="card shadow-sm">
                            <div class="card-header bg-dark text-white">
                                Comparativo de Momentos Fletores
                            </div>
                            <ul class="list-group list-group-flush">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Método Winkler (Apoios Fixos)
                                    <span class="badge bg-secondary rounded-pill" style="font-size: 1em;">{{ resultados.M_winkler }} kgf.cm</span>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                    Método Zimmermann (Apoios Elásticos)
                                    <span class="badge bg-primary rounded-pill" style="font-size: 1em;">{{ resultados.M_zim }} kgf.cm</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            {% else %}
                <div class="alert alert-light border text-center p-5">
                    <h4>Aguardando Dados...</h4>
                    <p>Preencha as propriedades do trilho e da via para iniciar a verificação.</p>
                    <img src="https://gruposiderbras.com.br/wp-content/uploads/2024/03/image-9.png" class="img-fluid opacity-25" style="max-height: 200px;">
                </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}